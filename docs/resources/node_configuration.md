---
page_title: "castai_node_configuration Resource - terraform-provider-castai"
subcategory: ""
description: |-
  
---

# castai_node_configuration (Resource)



Manages cluster node configurations that will be applied to CAST AI provisioned nodes.
If you choose to add new node configuration that will be applied to all newly provisioned nodes, you will have to mark
it as the default using `castai_node_configuration_default` resource.

## Example Usage

```terraform
variable "init_script" {
  type    = string
  default = <<EOF
#!/bin/bash
echo "hello"
EOF
}

resource "castai_node_configuration" "default" {
  name           = "default"
  cluster_id     = castai_eks_cluster.test.id
  disk_cpu_ratio = 35
  subnets        = aws_subnet.test[*].id
  init_script    = base64encode(var.init_script)
  docker_config  = jsonencode({
    "insecure-registries"      = ["registry.com:5000"],
    "max-concurrent-downloads" = 10
  })
  kubelet_config = jsonencode({
    "registryBurst" : 20,
    "registryPullQPS" : 10
  })
  container_runtime = "dockerd"
  tags              = {
    env = "development"
  }
  eks {
    instance_profile_arn = aws_iam_instance_profile.test.arn
    dns_cluster_ip       = "10.100.0.10"
    security_groups      = [aws_security_group.test.id]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_id` (String) CAST AI cluster id
- `name` (String) Name of the node configuration
- `subnets` (List of String) Subnet ids to be used for provisioned nodes

### Optional

- `aks` (Block List, Max: 1) (see [below for nested schema](#nestedblock--aks))
- `container_runtime` (String) Optional container runtime to be used by kubelet. Applicable for EKS only
- `disk_cpu_ratio` (Number) Disk to CPU ratio. Sets the number of GiBs to be added for every CPU on the node. Defaults to 0
- `docker_config` (String) Optional docker daemon configuration properties in JSON format. Provide only properties that you want to override. Applicable for EKS only. [Available values](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file)
- `eks` (Block List, Max: 1) (see [below for nested schema](#nestedblock--eks))
- `image` (String) Image to be used while provisioning the node. If nothing is provided will be resolved to latest available image based on Kubernetes version if possible
- `init_script` (String) Init script to be run on your instance at launch. Should not contain any sensitive data. Value should be base64 encoded
- `kops` (Block List, Max: 1) (see [below for nested schema](#nestedblock--kops))
- `kubelet_config` (String) Optional kubelet configuration properties in JSON format. Provide only properties that you want to override. Applicable for EKS only
- `ssh_public_key` (String) SSH public key to be used for provisioned nodes
- `tags` (Map of String) Tags to be added on cloud instances for provisioned nodes
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--aks"></a>
### Nested Schema for `aks`

Optional:

- `max_pods_per_node` (Number) Maximum number of pods that can be run on a node, which affects how many IP addresses you will need for each node. Defaults to 30


<a id="nestedblock--eks"></a>
### Nested Schema for `eks`

Required:

- `instance_profile_arn` (String) Cluster's instance profile ARN used for CAST provisioned nodes
- `security_groups` (List of String) Cluster's security groups configuration for CAST provisioned nodes

Optional:

- `dns_cluster_ip` (String) IP address to use for DNS queries within the cluster
- `key_pair_id` (String) AWS key pair ID to be used for provisioned nodes. Has priority over ssh_public_key


<a id="nestedblock--kops"></a>
### Nested Schema for `kops`

Optional:

- `key_pair_id` (String) AWS key pair ID to be used for provisioned nodes. Has priority over sshPublicKey


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


## Importing
You can use the `terraform import` command to import existing node configuration to Terraform state.

To import a resource, first write a resource block for it in your configuration, establishing the name by which
it will be known to Terraform:
```hcl
resource "castai_node_configuration" "default" {
  # ...
}
```

Now terraform import can be run to attach an existing node configuration to this resource:
```shell
$ terraform import castai_node_configuration.default <cluster_id>/default
```

If you are using CAST AI Terraform modules, import command will be slightly different:
```shell
$ terraform import 'module.castai-eks-cluster.castai_node_configuration.this["default"]' <cluster_id>/default
```