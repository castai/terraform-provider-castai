---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "castai_rebalancing_schedule Resource - terraform-provider-castai"
subcategory: ""
description: |-
  CAST AI rebalancing schedule resource to manage rebalancing schedules.
---

# castai_rebalancing_schedule (Resource)

CAST AI rebalancing schedule resource to manage rebalancing schedules.

## Example Usage

```terraform
resource "castai_rebalancing_schedule" "spots" {
  name = "rebalance spots at every 30th minute"
  schedule {
    cron = "*/30 * * * *"
  }
  trigger_conditions {
    savings_percentage = 20
  }
  launch_configuration {
    # only consider instances older than 5 minutes
    node_ttl_seconds         = 300
    num_targeted_nodes       = 3
    rebalancing_min_nodes    = 2
    keep_drain_timeout_nodes = false
    selector = jsonencode({
      nodeSelectorTerms = [{
        matchExpressions = [
          {
            key      = "scheduling.cast.ai/spot"
            operator = "Exists"
          }
        ]
      }]
    })
    execution_conditions {
      enabled                     = true
      achieved_savings_percentage = 10
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `launch_configuration` (Block List, Min: 1, Max: 1) (see [below for nested schema](#nestedblock--launch_configuration))
- `name` (String) Name of the schedule.
- `schedule` (Block List, Min: 1, Max: 1) (see [below for nested schema](#nestedblock--schedule))
- `trigger_conditions` (Block List, Min: 1, Max: 1) (see [below for nested schema](#nestedblock--trigger_conditions))

### Optional

- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--launch_configuration"></a>
### Nested Schema for `launch_configuration`

Optional:

- `aggressive_mode` (Boolean) When enabled rebalancing will also consider problematic pods (pods without controller, job pods, pods with removal-disabled annotation) as not-problematic.
- `execution_conditions` (Block List, Max: 1) (see [below for nested schema](#nestedblock--launch_configuration--execution_conditions))
- `keep_drain_timeout_nodes` (Boolean) Defines whether the nodes that failed to get drained until a predefined timeout, will be kept with a rebalancing.cast.ai/status=drain-failed annotation instead of forcefully drained.
- `node_ttl_seconds` (Number) Specifies amount of time since node creation before the node is allowed to be considered for automated rebalancing.
- `num_targeted_nodes` (Number) Maximum number of nodes that will be selected for rebalancing.
- `rebalancing_min_nodes` (Number) Minimum number of nodes that should be kept in the cluster after rebalancing.
- `selector` (String) Node selector in JSON format.
- `target_node_selection_algorithm` (String) Defines the algorithm used to select the target nodes for rebalancing.

<a id="nestedblock--launch_configuration--execution_conditions"></a>
### Nested Schema for `launch_configuration.execution_conditions`

Required:

- `enabled` (Boolean) Enables or disables the execution conditions.

Optional:

- `achieved_savings_percentage` (Number) The percentage of the predicted savings that must be achieved in order to fully execute the plan.If the savings are not achieved after creating the new nodes, the plan will fail and delete the created nodes.



<a id="nestedblock--schedule"></a>
### Nested Schema for `schedule`

Required:

- `cron` (String) Cron expression defining when the schedule should trigger.

  The `cron` expression can optionally include the `CRON_TZ` variable at the beginning to specify the timezone in which the schedule should be interpreted.

  Example:
  ```plaintext
  CRON_TZ=America/New_York 0 12 * * ?
  ```
  In the example above, the `CRON_TZ` variable is set to "America/New_York" indicating that the cron expression should be interpreted in the Eastern Time (ET) timezone.

  To retrieve a list of available timezone values, you can use the following API endpoint:

  GET https://api.cast.ai/v1/time-zones

  When using the `CRON_TZ` variable, ensure that the specified timezone is valid and supported by checking the list of available timezones from the API endpoint.  If the `CRON_TZ` variable is not specified, the cron expression will be interpreted in the UTC timezone.


<a id="nestedblock--trigger_conditions"></a>
### Nested Schema for `trigger_conditions`

Required:

- `savings_percentage` (Number) Defines the minimum percentage of savings expected.

Optional:

- `ignore_savings` (Boolean) If true, the savings percentage will be ignored and the rebalancing will be triggered regardless of the savings percentage.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)

## Import

Import is supported using the following syntax:

```shell
# Associate terraform resource "spots" with a rebalancing schedule named "spots".
terraform import 'castai_rebalancing_schedule.spots' spots

# Importing via direct schedule ID is also possible.
terraform import 'castai_rebalancing_schedule.spots' b4e69e0c-1762-45eb-bd4f-85cb172e6ad3
```
