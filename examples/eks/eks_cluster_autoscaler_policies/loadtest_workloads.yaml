  # monarch-master - Driver deployment (on-demand nodes)
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: monarch-master
    namespace: default
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: monarch-master
    template:
      metadata:
        labels:
          app: monarch-master
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
      spec:
        containers:
        - name: monarch-master
          image: nginx:latest
          resources:
            requests:
              cpu: "500m"
              memory: "1Gi"
              ephemeral-storage: "4Mi"
        nodeSelector:
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
          spark-nodeselect-preemptible: "false"
        terminationGracePeriodSeconds: 10
  ---
  # monarch-prep - PREP phase workers (spot nodes)
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: monarch-prep
    namespace: default
  spec:
    replicas: 0  # Adjust to trigger scale-up
    selector:
      matchLabels:
        app: monarch-prep
    template:
      metadata:
        labels:
          app: monarch-prep
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
      spec:
        containers:
        - name: monarch-prep
          image: nginx:latest
          resources:
            requests:
              cpu: "12800m"
              memory: "44800Mi"
              ephemeral-storage: "4Mi"
        nodeSelector:
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
          spark-nodeselect-preemptible: "true"
        terminationGracePeriodSeconds: 10
  ---
  # monarch-mig - MIG phase workers (spot nodes, higher CPU)
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: monarch-mig
    namespace: default
  spec:
    replicas: 0  # Adjust to trigger scale-up
    selector:
      matchLabels:
        app: monarch-mig
    template:
      metadata:
        labels:
          app: monarch-mig
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
      spec:
        containers:
        - name: monarch-mig
          image: nginx:latest
          resources:
            requests:
              cpu: "25600m"
              memory: "44800Mi"
              ephemeral-storage: "4Mi"
        nodeSelector:
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
          spark-nodeselect-preemptible: "true"
        terminationGracePeriodSeconds: 10
  ---
  # monarch-accumall - ACCUMALL phase workers (spot nodes)
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: monarch-accumall
    namespace: default
  spec:
    replicas: 0  # Adjust to trigger scale-up
    selector:
      matchLabels:
        app: monarch-accumall
    template:
      metadata:
        labels:
          app: monarch-accumall
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
      spec:
        containers:
        - name: monarch-accumall
          image: nginx:latest
          resources:
            requests:
              cpu: "12800m"
              memory: "44800Mi"
              ephemeral-storage: "4Mi"
        nodeSelector:
          spark-nodeselect-instance-type: amd64-64-16
          spark-nodeselect-nodepool-group: hyper
          spark-nodeselect-preemptible: "true"
        terminationGracePeriodSeconds: 10
